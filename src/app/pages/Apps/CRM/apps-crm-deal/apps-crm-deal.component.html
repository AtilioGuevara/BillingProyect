<app-page-title [Title]="'Deal'" [pageTitle]="'CRM'"></app-page-title>

<div>
  <div>
    <div>
      <div class="flex flex-wrap justify-between gap-5 mb-5">
        <div>
          <div class="relative group/form">
            <input type="text" [(ngModel)]="searchQuery" class="ltr:pl-9 rtl:pr-9 form-input ltr:group-[&.right]/form:pr-9 rtl:group-[&.right]/form:pl-9 ltr:group-[&.right]/form:pl-4 rtl:group-[&.right]/form:pr-4" placeholder="Search for ..." />
            <div class="absolute inset-y-0 flex items-center text-gray-500 dark:text-dark-500 ltr:left-3 rtl:right-3 ltr:group-[&.right]/form:right-3 rtl:group-[&.right]/form:left-3 ltr:group-[&.right]/form:left-auto rtl:group-[&.right]/form:right-auto focus:outline-hidden">
              <lucide-angular name="search" class="size-4"></lucide-angular>
            </div>
          </div>
        </div>
        <div>
          <div class="flex flex-wrap gap-2">
            <button class="btn btn-icon btn-icon-text" title="card" [ngClass]="isCardView ? 'btn btn-primary' : 'btn btn-sub-gray'" (click)="setView(true)">
              <lucide-angular name="gallery-vertical-end" class="size-5"></lucide-angular>
            </button>

            <button class="btn btn-icon btn-icon-text" title="list" [ngClass]="!isCardView ? 'btn btn-primary' : 'btn btn-sub-gray'" (click)="setView(false)">
              <lucide-angular name="list" class="size-5"></lucide-angular>
            </button>

            <div class="dropdown shrink-0">
              <button x-ref="button" domixDropdownToggle [dropdownMenu]="dropdown1" title="dropdown-button" type="button" class="btn btn-sub-gray">
                <lucide-angular name="filter" class="inline-block ltr:mr-1 rtl:ml-1 align-center size-4">
                </lucide-angular> Sort
                By
              </button>

              <div #dropdown1 class="!fixed p-2 dropdown-menu hidden !w-64" dropdown-position="right">
                <ul>
                  <li>
                    <a href="javascript: void(0);" x-on:click="init , sort(null) " class="dropdown-item">
                      No Sorting
                    </a>
                  </li>
                  <li>
                    <a href="javascript: void(0);" (click)="sort('desc')" class="dropdown-item">
                      Alphabetical (A -> Z)
                    </a>
                  </li>
                  <li>
                    <a href="javascript: void(0);" (click)="sort('asc')" class="dropdown-item">
                      Reverse Alphabetical (Z -> A)
                    </a>
                  </li>
                  <li>
                    <a href="javascript: void(0);" (click)="statusSort()" class="dropdown-item">
                      Status
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div [ngClass]="{'group card-view gap-x-5 grid grid-cols-12': isCardView, 'list-view group': !isCardView}">
            <ng-container *ngFor="let deal of displayedData; let index= index">
              <div class="card-view-col">
                <div class="card">
                  <div class="card-body">
                    <div class="card-view-wrap group-[&.list-view]:flex group-[&.list-view]:justify-between gap-4 group-[&.list-view]:overflow-x-auto group-[&.list-view]:whitespace-nowrap">
                      <div class="flex items-center gap-3 card-view-col-12">
                        <div class="p-2 border border-gray-200 rounded-md dark:border-dark-800 size-12 shrink-0">
                          <img [src]="deal.image" alt="">
                        </div>
                        <div class="overflow-hidden grow">
                          <h6 class="mb-1 truncate"><a href="javascript:void(0);">{{deal.projectName}}</a>
                          </h6>
                          <p class="text-gray-500 dark:text-dark-500"><span>{{deal.amount}}</span> <span class="group-[&.card-view]:inline-block hidden">-
                              <span class="group-[&.card-view]:inline-block hidden"></span>{{deal.createDate}}</span></p>
                        </div>
                      </div>
                      <div class="group-[&.list-view]:w-28 card-view-hidden">
                        <p class="text-gray-500 dark:text-dark-500">{{deal.createDate}}</p>
                      </div>
                      <div class="group-[&.list-view]:w-28 card-view-col-12">
                        <p class="text-gray-500 dark:text-dark-500 truncate group-[&.card-view]:text-gray-800 dark:group-[&.card-view]:text-dark-50 group-[&.card-view]:font-medium">
                          {{deal.company}}</p>
                        <p class="group-[&.card-view]:block hidden mt-1 text-gray-500 dark:text-dark-500 line-clamp-2">
                          {{deal.content}}</p>
                      </div>
                      <div class="w-28 card-view-col-12">
                        <div class="flex items-center gap-2">
                          <p class="badge badge-pink">
                            {{ getDaysLeftText(deal.daysLeft) }}
                          </p>
                          <span class="badge" [ngClass]="{
                          'badge-green': deal.status === 'Active',
                          'badge-gray': deal.status === 'Unactive'
                        }">
                            {{ deal.status }}
                          </span>
                        </div>
                      </div>
                      <div class="card-view-col-12">
                        <div class="flex flex-wrap items-center group-[&.list-view]:justify-end gap-2">
                          <button type="button" (click)="openCallModal(deal)" class="border-dashed btn btn-dashed-primary shrink-0"><i class="align-baseline ltr:mr-1 rtl:ml-1 ri-phone-line"></i> Call
                          </button>
                          <button type="button" (click)="openmessageModal(deal)" class="border-dashed btn btn-dashed-yellow group-[&.card-view]:w-full"><i class="align-baseline ltr:mr-1 rtl:ml-1 ri-message-2-line"></i> Message
                          </button>
                          <button type="button" class="btn btn-sub-gray shrink-0 btn-icon-text btn-icon" title="edit"><i class="ri-pencil-line"></i></button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="displayedData.length == 0">
              <div class="p-8">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" class="mx-auto size-12" viewBox="0 0 48 48">
                  <linearGradient id="SVGID_1__h35ynqzIJzH4_gr1" x1="34.598" x2="15.982" y1="15.982" y2="34.598" gradientUnits="userSpaceOnUse">
                    <stop offset="0" stop-color="#60e8fe"></stop>
                    <stop offset=".033" stop-color="#6ae9fe"></stop>
                    <stop offset=".197" stop-color="#97f0fe"></stop>
                    <stop offset=".362" stop-color="#bdf5ff"></stop>
                    <stop offset=".525" stop-color="#dafaff"></stop>
                    <stop offset=".687" stop-color="#eefdff"></stop>
                    <stop offset=".846" stop-color="#fbfeff"></stop>
                    <stop offset="1" stop-color="#fff"></stop>
                  </linearGradient>
                  <path fill="url(#SVGID_1__h35ynqzIJzH4_gr1)" d="M40.036,33.826L31.68,25.6c0.847-1.739,1.335-3.684,1.335-5.748c0-7.27-5.894-13.164-13.164-13.164	S6.688,12.582,6.688,19.852c0,7.27,5.894,13.164,13.164,13.164c2.056,0,3.995-0.485,5.728-1.326l3.914,4.015l4.331,4.331	c1.715,1.715,4.496,1.715,6.211,0C41.751,38.321,41.751,35.541,40.036,33.826z">
                  </path>
                  <path fill="none" stroke="#10cfe3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="3" d="M31.95,25.739l8.086,8.086c1.715,1.715,1.715,4.496,0,6.211l0,0c-1.715,1.715-4.496,1.715-6.211,0	l-4.331-4.331">
                  </path>
                  <path fill="none" stroke="#10cfe3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="3" d="M7.525,24.511c-1.771-4.694-0.767-10.196,3.011-13.975c3.847-3.847,9.48-4.817,14.228-2.912">
                  </path>
                  <path fill="none" stroke="#10cfe3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="3" d="M30.856,12.603c3.376,5.114,2.814,12.063-1.688,16.565c-4.858,4.858-12.565,5.129-17.741,0.814">
                  </path>
                </svg>
                <p class="mt-2 text-center text-gray-500 dark:text-dark-500">No matching records found</p>
              </div>
            </ng-container>
          </div>

        </div>

        <app-domix-pagination [currentPage]="currentPage" [totalPages]="totalPages" [showingStart]="showingStart" [showingEnd]="showingEnd" [totalResults]="displayedData.length" (pageChanged)="onPageChange($event)">
        </app-domix-pagination>
      </div>
    </div>



  </div>
</div>