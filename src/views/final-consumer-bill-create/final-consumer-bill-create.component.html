<div class="card shadow-lg p-4 bg-white">
  <h2 class="text-2xl font-bold mb-4 text-purple-700">Crear Factura Consumidor Final</h2>
  <form [formGroup]="billForm" (ngSubmit)="submit()">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <!-- Código de generación -->
      <div>
        <label class="font-semibold text-blue-900">Código de generación</label>
        <input formControlName="generationCode" class="input input-bordered w-full border-purple-700" maxlength="36" />
        <div *ngIf="billForm.get('generationCode')?.invalid && billForm.get('generationCode')?.touched" class="text-red-500 text-xs">Debe tener exactamente 36 caracteres</div>
      </div>
      <!-- Número de control -->
      <div>
        <label class="font-semibold text-blue-900">Número de control</label>
        <input formControlName="controlNumber" class="input input-bordered w-full border-purple-700" />
        <div *ngIf="billForm.get('controlNumber')?.invalid && billForm.get('controlNumber')?.touched" class="text-red-500 text-xs">Formato: DTE-03-12345678-000000000000001</div>
      </div>
      <!-- Fecha de generación -->
      <div>
        <label class="font-semibold text-blue-900">Fecha de generación</label>
        <input type="datetime-local" formControlName="billGenerationDate" class="input input-bordered w-full border-purple-700" />
      </div>
      <!-- Cuenta de usuario -->
      <div>
        <label class="font-semibold text-blue-900">Cuenta de usuario</label>
        <input formControlName="account" class="input input-bordered w-full border-purple-700" />
      </div>
      <!-- Condición de pago -->
      <div>
        <label class="font-semibold text-blue-900">Condición de pago</label>
        <input formControlName="paymentCondition" class="input input-bordered w-full border-purple-700" />
      </div>
    </div>
    <hr class="my-4 border-purple-700" />
    <h3 class="text-lg font-bold text-purple-700 mb-2">Datos de la Compañía</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="font-semibold text-blue-900">Nombre</label>
        <input formControlName="companyName" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Documento (NIT)</label>
        <input formControlName="companyDocument" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Dirección</label>
        <input formControlName="companyAddress" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Email</label>
        <input formControlName="companyEmail" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Teléfono</label>
        <input formControlName="companyPhone" class="input input-bordered w-full border-purple-700" />
      </div>
    </div>
    <hr class="my-4 border-purple-700" />
    <h3 class="text-lg font-bold text-purple-700 mb-2">Datos del Cliente</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="font-semibold text-blue-900">Nombre</label>
        <input formControlName="customerName" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Documento</label>
        <input formControlName="customerDocument" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Dirección</label>
        <input formControlName="customerAddress" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Email</label>
        <input formControlName="customerEmail" class="input input-bordered w-full border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Teléfono</label>
        <input formControlName="customerPhone" class="input input-bordered w-full border-purple-700" />
      </div>
    </div>
    <hr class="my-4 border-purple-700" />
    <h3 class="text-lg font-bold text-purple-700 mb-2">Productos</h3>
    <div formArrayName="products">
      <div *ngFor="let product of products.controls; let i = index" [formGroupName]="i" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-2">
        <input formControlName="productName" placeholder="Producto" class="input input-bordered border-purple-700" />
        <input type="number" formControlName="quantity" placeholder="Cantidad" class="input input-bordered border-purple-700" />
        <input type="number" formControlName="price" placeholder="Precio" class="input input-bordered border-purple-700" />
        <button type="button" (click)="removeProduct(i)" class="btn btn-sm btn-error ml-2" *ngIf="products.length > 1">Eliminar</button>
      </div>
      <button type="button" (click)="addProduct()" class="btn btn-sm btn-primary bg-purple-700 text-white">Agregar producto</button>
    </div>
    <hr class="my-4 border-purple-700" />
    <h3 class="text-lg font-bold text-purple-700 mb-2">Totales</h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="font-semibold text-blue-900">Ventas no gravadas</label>
        <input type="number" formControlName="nonTaxedSales" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Ventas exentas</label>
        <input type="number" formControlName="exemptSales" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Ventas gravadas</label>
        <input type="number" formControlName="taxedSales" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">IVA</label>
        <input type="number" formControlName="iva" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">IVA percibido</label>
        <input type="number" formControlName="perceivedIva" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">IVA retenido</label>
        <input type="number" formControlName="withheldIva" class="input input-bordered border-purple-700" />
      </div>
      <div>
        <label class="font-semibold text-blue-900">Total con IVA</label>
        <input type="number" formControlName="totalWithIva" class="input input-bordered border-purple-700" />
      </div>
    </div>
    <button type="submit" class="btn bg-purple-700 text-white mt-6 w-full">Crear factura</button>
  </form>
</div>
